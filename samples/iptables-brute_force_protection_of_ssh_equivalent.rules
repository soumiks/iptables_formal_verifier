# Limit new SSH connections to 3 attempts per minute per IP address
-A INPUT -p tcp --dport 22 -m conntrack --ctstate NEW -m recent --set

# Accept traffic if the rate limit is not exceeded
-A INPUT -p tcp --dport 22 -m conntrack --ctstate NEW -m recent --update --seconds 60 --hitcount 4 -j ACCEPT

# Optional: Log and drop traffic that exceeds the limit
-A INPUT -p tcp --dport 22 -j LOG --log-prefix "SSH Brute Force Attempt: "
-A INPUT -p tcp --dport 22 -j DROP

